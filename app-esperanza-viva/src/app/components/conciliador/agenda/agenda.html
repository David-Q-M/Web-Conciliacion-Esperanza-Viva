<div class="admin-container">
  <aside class="sidebar-viva">
    <div class="logo-section">
      <h5 class="m-0 fw-bold text-dark">ESPERANZA VIVA</h5>
      <small class="text-dark fw-bold">PANEL CONCILIADOR</small>
    </div>
    <nav class="sidebar-nav">
      <a class="nav-link-viva" routerLink="/conciliador/mis-casos" routerLinkActive="active">
        <i class="bi bi-envelope-fill me-2"></i> Mis Casos
      </a>
      <a class="nav-link-viva active" routerLink="/conciliador/agenda" routerLinkActive="active">
        <i class="bi bi-calendar-check me-2"></i> Mi Agenda
      </a>
      <a class="nav-link-viva" routerLink="/conciliador/historial" routerLinkActive="active">
        <i class="bi bi-clock-history me-2"></i> Historial
      </a>
    </nav>
    <div class="sidebar-footer px-3">
      <button class="btn w-100 fw-bold" style="background: #000; color: #fff;" (click)="cerrarSesion()">
        <i class="bi bi-box-arrow-left"></i> Cerrar Sesión
      </button>
    </div>
  </aside>

  <main class="main-content-viva">
    <header class="d-flex justify-content-between align-items-center mb-5">
      <div>
        <h2 class="text-warning fw-bold m-0"><i class="bi bi-calendar3 me-2"></i> Mi Agenda de Audiencias</h2>
        <p class="text-secondary small m-0">Gestiona tus próximas sesiones programadas y notificadas</p>
      </div>
      <div class="admin-badge text-end">
        <div class="text-white fw-bold">{{ conciliadorNombre }}</div>
        <small class="text-success">● Conciliador</small>
      </div>
    </header>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner-border text-warning" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="text-muted mt-2">Cargando tu agenda...</p>
    </div>

    <!-- Agenda Grid -->
    <div class="row" *ngIf="!isLoading">
      <div class="col-md-6 col-lg-4 mb-4" *ngFor="let au of audiencias">
        <div class="card bg-dark border-warning shadow-lg h-100 agenda-card">
          <div class="card-header border-warning d-flex justify-content-between align-items-center bg-transparent">
            <span class="text-warning fw-bold">{{ au.numeroExpediente }}</span>
            <span class="badge" [ngClass]="{
                            'bg-info text-dark': au.estado === 'NOTIFICADO', 
                            'bg-secondary': au.estado === 'PROGRAMADO'
                        }">
              {{ au.estado }}
            </span>
          </div>

          <div class="card-body text-light">
            <div class="mb-3">
              <small class="text-muted d-block text-uppercase fw-bold" style="font-size: 0.7rem;">Fecha y Hora</small>
              <div class="d-flex align-items-center fs-5">
                <i class="bi bi-calendar-event me-2 text-warning"></i>
                {{ au.fechaAudiencia | date:'dd/MM/yyyy' }}
                <span class="mx-2">|</span>
                <i class="bi bi-clock me-2 text-warning"></i>
                {{ au.horaAudiencia }}
              </div>
            </div>

            <p class="mb-3 small">
              <i class="bi bi-geo-alt me-2 text-secondary"></i> {{ au.lugar }}
            </p>

            <hr class="border-secondary opacity-50">

            <div class="small">
              <p class="mb-1 d-flex justify-content-between">
                <span class="text-muted">Solicitante:</span>
                <span class="text-end text-white">{{ au.solicitanteNombre }}</span>
              </p>
              <p class="mb-0 d-flex justify-content-between">
                <span class="text-muted">Invitado:</span>
                <span class="text-end text-white">{{ au.invitadoNombre }}</span>
              </p>
              <p class="mt-2 text-end text-info fw-bold fst-italic">{{ au.materia }}</p>
            </div>
          </div>

          <div class="card-footer border-warning bg-transparent pt-3 pb-3">
            <button *ngIf="au.estado === 'PROGRAMADO'" class="btn btn-outline-secondary w-100 disabled"
              style="opacity: 0.7; border-style: dashed;">
              <i class="bi bi-hourglass-split me-1"></i> Esperando Notificador
            </button>

            <button *ngIf="au.estado === 'NOTIFICADO'"
              class="btn btn-warning w-100 fw-bold text-dark shadow-sm btn-hover-effect"
              [routerLink]="['/conciliador/registro-audiencia', au.id]">
              <i class="bi bi-play-fill me-1"></i> INICIAR AUDIENCIA
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="audiencias.length === 0 && !isLoading" class="alert alert-dark border-secondary text-center py-5">
      <i class="bi bi-check-circle fs-1 text-success mb-3 d-block"></i>
      <h5 class="text-white">¡Todo al día!</h5>
      <p class="text-secondary m-0 text-white-50">No tienes audiencias programadas ni notificadas pendientes en este
        momento.</p>
    </div>
  </main>
</div>